2024-04-06 13:36:14,850 INFO    StreamThr :3970 [internal.py:wandb_internal():86] W&B internal server running at pid: 3970, started at: 2024-04-06 13:36:14.848367
2024-04-06 13:36:14,851 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: status
2024-04-06 13:36:14,859 INFO    WriterThread:3970 [datastore.py:open_for_write():87] open: /home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce/train/scripts/wandb/run-20240406_133614-0nxydl9d/run-0nxydl9d.wandb
2024-04-06 13:36:14,863 DEBUG   SenderThread:3970 [sender.py:send():378] send: header
2024-04-06 13:36:14,886 DEBUG   SenderThread:3970 [sender.py:send():378] send: run
2024-04-06 13:36:15,507 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: check_version
2024-04-06 13:36:15,509 INFO    SenderThread:3970 [dir_watcher.py:__init__():211] watching files in: /home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce/train/scripts/wandb/run-20240406_133614-0nxydl9d/files
2024-04-06 13:36:15,509 INFO    SenderThread:3970 [sender.py:_start_run_threads():1099] run started: 0nxydl9d with start time 1712410574.854051
2024-04-06 13:36:15,509 DEBUG   SenderThread:3970 [sender.py:send_request():405] send_request: check_version
2024-04-06 13:36:15,611 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: run_start
2024-04-06 13:36:15,621 DEBUG   HandlerThread:3970 [system_info.py:__init__():26] System info init
2024-04-06 13:36:15,621 DEBUG   HandlerThread:3970 [system_info.py:__init__():41] System info init done
2024-04-06 13:36:15,621 INFO    HandlerThread:3970 [system_monitor.py:start():194] Starting system monitor
2024-04-06 13:36:15,621 INFO    SystemMonitor:3970 [system_monitor.py:_start():158] Starting system asset monitoring threads
2024-04-06 13:36:15,621 INFO    HandlerThread:3970 [system_monitor.py:probe():214] Collecting system info
2024-04-06 13:36:15,629 INFO    SystemMonitor:3970 [interfaces.py:start():190] Started cpu monitoring
2024-04-06 13:36:15,631 INFO    SystemMonitor:3970 [interfaces.py:start():190] Started disk monitoring
2024-04-06 13:36:15,632 INFO    SystemMonitor:3970 [interfaces.py:start():190] Started gpu monitoring
2024-04-06 13:36:15,632 INFO    SystemMonitor:3970 [interfaces.py:start():190] Started memory monitoring
2024-04-06 13:36:15,633 INFO    SystemMonitor:3970 [interfaces.py:start():190] Started network monitoring
2024-04-06 13:36:15,634 DEBUG   HandlerThread:3970 [system_info.py:probe():150] Probing system
2024-04-06 13:36:15,649 DEBUG   HandlerThread:3970 [system_info.py:_probe_git():135] Probing git
2024-04-06 13:36:15,671 DEBUG   HandlerThread:3970 [system_info.py:_probe_git():143] Probing git done
2024-04-06 13:36:15,671 DEBUG   HandlerThread:3970 [system_info.py:probe():198] Probing system done
2024-04-06 13:36:15,671 DEBUG   HandlerThread:3970 [system_monitor.py:probe():223] {'os': 'Linux-5.15.0-1052-gcp-x86_64-with-glibc2.31', 'python': '3.9.19', 'heartbeatAt': '2024-04-06T13:36:15.634900', 'startedAt': '2024-04-06T13:36:14.817843', 'docker': None, 'cuda': None, 'args': ('--local_rank=0', '--override-opt_param-scheduler', '--adam-beta1', '0.9', '--adam-beta2', '0.95', '--tensor-model-parallel-size', '1', '--init-method-std', '0.02', '--lr-decay-tokens', '300000000000', '--lr-warmup-tokens', '3000000000', '--micro-batch-size', '16', '--exit-duration-in-mins', '30000000', '--global-batch-size', '256', '--num-layers', '12', '--hidden-size', '768', '--num-attention-heads', '12', '--seq-length', '2048', '--max-position-embeddings', '2048', '--train-tokens', '300000000000', '--train-samples', '292968750', '--lr', '6.0e-4', '--min-lr', '1.0e-6', '--lr-decay-style', 'cosine', '--split', '949,50,1', '--log-interval', '10', '--eval-interval', '100', '--eval-iters', '10', '--save-interval', '700', '--weight-decay', '0.1', '--clip-grad', '1.0', '--hysteresis', '2', '--num-workers', '0', '--fp16', '--seed', '1234', '--load', '/home/ext_tatsunari1020_gmail_com/../../persistentshare/storage/team_haijima/tatsu/model_checkpoint/checkpoint/gpt_0.125B_tok300B_lr6.0e-4_min1.0e-6_w3000M_d300B_cosine_gbs256_mbs16_g_pp1_seed1234_rebase', '--save', '/home/ext_tatsunari1020_gmail_com/../../persistentshare/storage/team_haijima/tatsu/model_checkpoint/checkpoint/gpt_0.125B_tok300B_lr6.0e-4_min1.0e-6_w3000M_d300B_cosine_gbs256_mbs16_g_pp1_seed1234_rebase', '--no-async-tensor-model-parallel-allreduce', '--use-flash-attn-v2', '--tensorboard-queue-size', '1', '--log-timers-to-tensorboard', '--log-batch-size-to-tensorboard', '--log-validation-ppl-to-tensorboard', '--tensorboard-dir', '/home/ext_tatsunari1020_gmail_com/../../persistentshare/storage/team_haijima/tatsu/model_checkpoint/tensorboard/gpt_0.125B_tok300B_lr6.0e-4_min1.0e-6_w3000M_d300B_cosine_gbs256_mbs16_g_pp1_seed1234_rebase_mlpre-g2-ghpc-6_2024.04.06_13.35.43', '--log-optimizer-states-to-tensorboard', '--tokenizer-type', 'SentencePieceTokenizer', '--tokenizer-model', '/home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce/train/output/step1_train_tokenizer/botchan/botchan.model', '--data-path', '/home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce/train/Megatron-DeepSpeed/dataset/arxiv_text_document', '--data-impl', 'mmap', '--deepspeed', '--deepspeed_config', '/home/ext_tatsunari1020_gmail_com/../../persistentshare/storage/team_haijima/tatsu/model_checkpoint/deepspeed_config/ds_config_gbs256_mbs16_log10_zero0.json', '--zero-stage', '0', '--pipeline-model-parallel-size', '1'), 'state': 'running', 'program': '/home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce/train/Megatron-DeepSpeed/pretrain_gpt.py', 'codePathLocal': None, 'codePath': 'train/Megatron-DeepSpeed/pretrain_gpt.py', 'git': {'remote': 'git@github.com:Tatsu1020/ucllm_nedo_prod.git', 'commit': 'bc4d1acb27191c8ab15e68a0865a8b7a63a2e12a'}, 'email': 'tatsunari1020@gmail.com', 'root': '/home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce', 'host': 'mlpre-g2-ghpc-6', 'username': 'ext_tatsunari1020_gmail_com', 'executable': '/home/ext_tatsunari1020_gmail_com/miniconda3/envs/.venv/bin/python', 'cpu_count': 48, 'cpu_count_logical': 48, 'cpu_freq': {'current': 2200.2320000000022, 'min': 0.0, 'max': 0.0}, 'cpu_freq_per_core': [{'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}, {'current': 2200.232, 'min': 0.0, 'max': 0.0}], 'disk': {'/': {'total': 193.6498260498047, 'used': 16.68667221069336}}, 'gpu': 'NVIDIA L4', 'gpu_count': 1, 'gpu_devices': [{'name': 'NVIDIA L4', 'memory_total': 24152899584}], 'memory': {'total': 377.87186431884766}}
2024-04-06 13:36:15,671 INFO    HandlerThread:3970 [system_monitor.py:probe():224] Finished collecting system info
2024-04-06 13:36:15,671 INFO    HandlerThread:3970 [system_monitor.py:probe():227] Publishing system info
2024-04-06 13:36:15,672 DEBUG   HandlerThread:3970 [system_info.py:_save_conda():207] Saving list of conda packages installed into the current environment
2024-04-06 13:36:16,512 INFO    Thread-12 :3970 [dir_watcher.py:_on_file_created():271] file/dir created: /home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce/train/scripts/wandb/run-20240406_133614-0nxydl9d/files/conda-environment.yaml
2024-04-06 13:36:19,809 DEBUG   HandlerThread:3970 [system_info.py:_save_conda():219] Saving conda packages done
2024-04-06 13:36:19,815 INFO    HandlerThread:3970 [system_monitor.py:probe():229] Finished publishing system info
2024-04-06 13:36:19,836 DEBUG   SenderThread:3970 [sender.py:send():378] send: files
2024-04-06 13:36:19,836 INFO    SenderThread:3970 [sender.py:_save_file():1365] saving file wandb-metadata.json with policy now
2024-04-06 13:36:20,012 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: python_packages
2024-04-06 13:36:20,012 DEBUG   SenderThread:3970 [sender.py:send_request():405] send_request: python_packages
2024-04-06 13:36:20,013 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: stop_status
2024-04-06 13:36:20,018 DEBUG   SenderThread:3970 [sender.py:send_request():405] send_request: stop_status
2024-04-06 13:36:20,020 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: status_report
2024-04-06 13:36:20,034 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: internal_messages
2024-04-06 13:36:20,365 DEBUG   SenderThread:3970 [sender.py:send():378] send: telemetry
2024-04-06 13:36:20,513 INFO    Thread-12 :3970 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce/train/scripts/wandb/run-20240406_133614-0nxydl9d/files/conda-environment.yaml
2024-04-06 13:36:20,514 INFO    Thread-12 :3970 [dir_watcher.py:_on_file_created():271] file/dir created: /home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce/train/scripts/wandb/run-20240406_133614-0nxydl9d/files/wandb-metadata.json
2024-04-06 13:36:20,514 INFO    Thread-12 :3970 [dir_watcher.py:_on_file_created():271] file/dir created: /home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce/train/scripts/wandb/run-20240406_133614-0nxydl9d/files/requirements.txt
2024-04-06 13:36:20,514 INFO    Thread-12 :3970 [dir_watcher.py:_on_file_created():271] file/dir created: /home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce/train/scripts/wandb/run-20240406_133614-0nxydl9d/files/output.log
2024-04-06 13:36:21,665 INFO    wandb-upload_0:3970 [upload_job.py:push():131] Uploaded file /tmp/tmpytusa23kwandb/y9u962fs-wandb-metadata.json
2024-04-06 13:36:22,518 INFO    Thread-12 :3970 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce/train/scripts/wandb/run-20240406_133614-0nxydl9d/files/output.log
2024-04-06 13:36:25,165 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: status_report
2024-04-06 13:36:26,524 INFO    Thread-12 :3970 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce/train/scripts/wandb/run-20240406_133614-0nxydl9d/files/output.log
2024-04-06 13:36:30,166 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: status_report
2024-04-06 13:36:35,013 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: stop_status
2024-04-06 13:36:35,014 DEBUG   SenderThread:3970 [sender.py:send_request():405] send_request: stop_status
2024-04-06 13:36:35,016 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: internal_messages
2024-04-06 13:36:35,322 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: status_report
2024-04-06 13:36:40,322 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: status_report
2024-04-06 13:36:45,327 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: status_report
2024-04-06 13:36:45,673 INFO    Thread-12 :3970 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/ext_tatsunari1020_gmail_com/ucllm_nedo_prod_reproduce/train/scripts/wandb/run-20240406_133614-0nxydl9d/files/config.yaml
2024-04-06 13:36:49,735 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: partial_history
2024-04-06 13:36:49,778 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: partial_history
2024-04-06 13:36:49,778 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: partial_history
2024-04-06 13:36:50,013 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: stop_status
2024-04-06 13:36:50,014 DEBUG   SenderThread:3970 [sender.py:send_request():405] send_request: stop_status
2024-04-06 13:36:50,016 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: internal_messages
2024-04-06 13:36:51,318 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: status_report
2024-04-06 13:36:56,319 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: status_report
2024-04-06 13:37:01,323 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: status_report
2024-04-06 13:37:05,019 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: internal_messages
2024-04-06 13:37:05,020 DEBUG   HandlerThread:3970 [handler.py:handle_request():146] handle_request: stop_status
2024-04-06 13:37:05,020 DEBUG   SenderThread:3970 [sender.py:send_request():405] send_request: stop_status
